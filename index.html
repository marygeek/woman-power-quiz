<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>回答問題，獲得專屬於妳的 WOMEN 女力！- 我沒有腳本，但我有方向</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap');

        :root {
            --bg-color: #f5f0ec;
            --primary-text: #544c43;
            --title-green: #5e743e;
            --title-pink: #c4646b;
            --button-bg: #5e743e;
            --button-text: #ffffff;
            --button-hover-bg: #4a5c31;
        }

        body {
            margin: 0;
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg-color);
            background-image: url("data:image/svg+xml,%3Csvg width='6' height='6' viewBox='0 0 6 6' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%239C92AC' fill-opacity='0.1'%3E%3Cpath d='M5 0h1L0 6V5zM6 5v1H5z'/%3E%3C/g%3E%3C/svg%3E");
            color: var(--primary-text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px 0;
            box-sizing: border-box;
        }

        .container {
            width: 100%;
            max-width: 400px;
            min-height: 600px;
            background-color: rgba(255, 255, 255, 0.6);
            border-radius: 20px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            padding: 30px;
            box-sizing: border-box;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .page {
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.5s ease-in-out;
        }

        .page.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1, h2 {
            font-weight: 700;
        }
        
        #welcome-page h1 {
            color: var(--title-green);
            font-size: 2em;
        }
        
        #welcome-page h1 span {
            color: var(--title-pink);
        }

        #welcome-page p {
            font-size: 1.1em;
            line-height: 1.8;
            margin: 20px 0 40px;
        }

        .question-header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        #question-counter {
            font-size: 1em;
            color: var(--title-pink);
        }

        #back-button {
            background: none;
            border: 1px solid var(--primary-text);
            color: var(--primary-text);
            border-radius: 20px;
            padding: 5px 15px;
            cursor: pointer;
            visibility: hidden; /* Hide by default */
        }
        
        #back-button:hover {
            background: rgba(0,0,0,0.05);
        }

        #question-text {
            font-size: 1.5em;
            margin-bottom: 30px;
            line-height: 1.6;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            width: 100%;
            gap: 15px;
        }

        .option-btn, .action-btn {
            background-color: var(--button-bg);
            color: var(--button-text);
            border: none;
            border-radius: 10px;
            padding: 18px 20px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            width: 100%;
            box-sizing: border-box;
            font-family: 'Noto Sans TC', sans-serif;
        }

        .option-btn:hover, .action-btn:hover {
            background-color: var(--button-hover-bg);
            transform: scale(1.02);
        }
        
        #email-page h2 {
            color: var(--title-green);
            font-size: 1.6em;
            margin-bottom: 15px;
        }
        
        #email-page p {
            margin-bottom: 30px;
            font-size: 1.1em;
            line-height: 1.7;
        }

        #email-input {
            width: 100%;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 10px;
            font-size: 1em;
            box-sizing: border-box;
            margin-bottom: 20px;
            text-align: center;
        }

        #result-card {
            max-width: 100%;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .download-link {
            display: inline-block;
            margin-bottom: 25px;
            font-size: 0.9em;
            color: var(--primary-text);
        }
        
        .share-container p {
            margin: 0 0 10px 0;
            font-weight: bold;
        }

        .share-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .share-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: transform 0.2s;
        }
        
        .share-btn:hover {
            transform: scale(1.1);
        }

        .share-btn svg {
            width: 24px;
            height: 24px;
            fill: white;
        }
        
        .facebook { background-color: #1877F2; }
        .line { background-color: #06C755; }
        .threads { background-color: #000000; }

        #loading-page {
            font-size: 1.2em;
        }

    </style>
</head>
<body>

    <div class="container">
        <div id="welcome-page" class="page active">
            <h1>回答問題，獲得專屬於妳的<br><span>WOMEN 女力！</span></h1>
            <p>走完五個展區，妳是否和我一樣，看見了屬於自己的故事？<br>只要再回答以下提問，就能抽取一張 WOMEN 女力牌卡，收到專屬於妳的祝福與力量！</p>
            <button id="start-btn" class="action-btn">開始作答吧!</button>
        </div>

        <div id="quiz-page" class="page">
            <div class="question-header">
                <button id="back-button">&lt; 上一題</button>
                <span id="question-counter"></span>
            </div>
            <h2 id="question-text"></h2>
            <div class="options-container" id="options-container"></div>
        </div>

        <div id="email-page" class="page">
            <h2>領取妳的專屬女力卡</h2>
            <p>請輸入您的 Email，我們將立即為您揭曉專屬的女力牌卡。</p>
            <form id="email-form">
                <input type="email" id="email-input" placeholder="請輸入您的 Email" required>
                <button type="submit" class="action-btn">領取我的女力卡</button>
            </form>
        </div>

        <div id="loading-page" class="page">
            <p>正在生成您的女力卡...</p>
        </div>

        <div id="result-page" class="page">
            <a id="download-link" href="#" download="我的女力卡.jpg">
                <img id="result-card" src="" alt="女力卡">
            </a>
            <a id="download-prompt" class="download-link" href="#" download="我的女力卡.jpg">點此下載圖片，或長按圖片儲存</a>
            <div class="share-container">
                <p>分享妳的力量</p>
                <div class="share-buttons">
                    <button class="share-btn facebook" id="share-facebook">
                        <svg viewBox="0 0 24 24"><path d="M12 2.04C6.5 2.04 2 6.53 2 12.06C2 17.06 5.66 21.21 10.44 22V14.69H7.9V12.06H10.44V9.9C10.44 7.38 11.93 6.08 14.22 6.08C15.31 6.08 16.45 6.27 16.45 6.27V8.61H15.19C13.95 8.61 13.56 9.39 13.56 10.18V12.06H16.34L15.89 14.69H13.56V22C18.34 21.21 22 17.06 22 12.06C22 6.53 17.5 2.04 12 2.04Z"/></svg>
                    </button>
                    <button class="share-btn line" id="share-line">
                        <svg viewBox="0 0 24 24"><path d="M21.1,3.4C20.1,2.5,18.8,2,17.4,2H6.6C4.1,2,2,4.1,2,6.6v10.8c0,2.5,2.1,4.6,4.6,4.6h10.8c2.5,0,4.6-2.1,4.6-4.6V6.6 C22,5.2,21.5,3.9,21.1,3.4z M17.4,20H6.6C5.2,20,4,18.8,4,17.4V6.6C4,5.2,5.2,4,6.6,4h10.8C18.8,4,20,5.2,20,6.6v10.8 C20,18.8,18.8,20,17.4,20z M8.1,8.6v5.8h1.6V9.4l1.9,0V8.6H8.1z M12.8,14.4h1.7l2.5-5.8h-1.7l-1.6,4l-1.6-4h-1.7L12.8,14.4z M6.1,11.5c-0.6,0-1-0.4-1-1s0.4-1,1-1s1,0.4,1,1S6.7,11.5,6.1,11.5z"/></svg>
                    </button>
                    <button class="share-btn threads" id="share-threads">
                        <svg viewBox="0 0 24 24"><path d="M14.51,22c-2.83,0-5.13-2.3-5.13-5.13V9.33c0-0.41-0.34-0.75-0.75-0.75c-0.41,0-0.75,0.34-0.75,0.75v7.54 C7.88,19.7,5.58,22,2.75,22c-0.41,0-0.75-0.34-0.75-0.75c0-0.41,0.34-0.75,0.75-0.75c2,0,3.63-1.62,3.63-3.63V9.33 c0-1.25,1.02-2.27,2.27-2.27s2.27,1.02,2.27,2.27v7.54c0,2,1.62,3.63,3.63,3.63s3.63-1.62,3.63-3.63V9.33c0-0.41-0.34-0.75-0.75-0.75 s-0.75,0.34-0.75,0.75v7.54c0,2.83-2.3,5.13-5.13,5.13z M21.25,2C18.42,2,16.12,4.3,16.12,7.13v7.54c0,1.25-1.02,2.27-2.27,2.27 s-2.27-1.02-2.27-2.27V9.33c0-2-1.62-3.63-3.63-3.63S4.33,7.33,4.33,9.33v7.54c0,0.41,0.34,0.75,0.75,0.75s0.75-0.34,0.75-0.75 V9.33c0-2.83,2.3-5.13,5.13-5.13s5.13,2.3,5.13,5.13v7.54c0,2.83,2.3,5.13,5.13,5.13c0.41,0,0.75,0.34,0.75,0.75 c0,0.41-0.34,0.75-0.75,0.75c-2,0-3.63-1.62-3.63-3.63V7.13c0-2,1.62-3.63,3.63-3.63s3.63,1.62,3.63,3.63v7.54 c0,0.41,0.34,0.75,0.75,0.75s0.75-0.34,0.75-0.75V7.13C24,4.3,21.7,2,18.97,2C19.39,2,21.25,2,21.25,2z"/></svg>
                    </button>
                </div>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- CONFIGURATION ---
            const GOOGLE_SCRIPT_URL = 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE'; // !!! IMPORTANT: REPLACE THIS URL !!!

            const quizData = [
                {
                    question: "展區一：新生兒的姓氏只能隨父姓或隨母姓？",
                    options: ["是", "否"]
                },
                {
                    question: "展區二：顏色、服飾、稱呼...許多日常事物都可能隱含性別的暗示？",
                    options: ["是", "否"]
                },
                {
                    question: "展區三：如果人生可以重來，我希望回到哪個階段？",
                    options: ["剛出生", "青春期", "成熟期", "不想重來"]
                },
                {
                    question: "展區四：面對熟齡生活的改變，我的態度是？",
                    options: ["欣然接受", "順其自然", "恐懼緊張", "做好準備"]
                }
            ];

            const cardImages = [
                "https://i.imgur.com/GghJg1K.jpg", // 01智慧.jpg
                "https://i.imgur.com/lYt2YlR.jpg", // 02選擇.jpg
                "https://i.imgur.com/eB3sYc6.jpg", // 03蛻變.jpg
                "https://i.imgur.com/c6k2zJj.jpg", // 04賦權.jpg
                "https://i.imgur.com/7j4Z6wU.jpg"  // 05滋養.jpg
            ];
            
            const shareURL = 'https://ntwsc.tw/';
            const shareText = '我的專屬女力卡！快來新北市婦女服務中心，參觀女性生命週期常設展「我沒有腳本，但我有方向」！';

            // --- DOM ELEMENTS ---
            const pages = {
                welcome: document.getElementById('welcome-page'),
                quiz: document.getElementById('quiz-page'),
                email: document.getElementById('email-page'),
                loading: document.getElementById('loading-page'),
                result: document.getElementById('result-page')
            };

            const startBtn = document.getElementById('start-btn');
            const backBtn = document.getElementById('back-button');
            const questionCounter = document.getElementById('question-counter');
            const questionText = document.getElementById('question-text');
            const optionsContainer = document.getElementById('options-container');
            const emailForm = document.getElementById('email-form');
            const emailInput = document.getElementById('email-input');
            const resultCard = document.getElementById('result-card');
            const downloadLink = document.getElementById('download-link');
            const downloadPrompt = document.getElementById('download-prompt');
            const shareFacebook = document.getElementById('share-facebook');
            const shareLine = document.getElementById('share-line');
            const shareThreads = document.getElementById('share-threads');

            // --- STATE ---
            let currentQuestionIndex = 0;
            let userAnswers = [];

            // --- FUNCTIONS ---
            function showPage(pageName) {
                Object.values(pages).forEach(page => page.classList.remove('active'));
                pages[pageName].classList.add('active');
            }

            function renderQuestion(index) {
                const question = quizData[index];
                questionCounter.textContent = `問題 ${index + 1} / ${quizData.length}`;
                questionText.textContent = question.question;
                optionsContainer.innerHTML = '';

                question.options.forEach(optionText => {
                    const button = document.createElement('button');
                    button.textContent = optionText;
                    button.className = 'option-btn';
                    button.addEventListener('click', () => handleOptionClick(optionText));
                    optionsContainer.appendChild(button);
                });

                backBtn.style.visibility = index > 0 ? 'visible' : 'hidden';
            }

            function handleOptionClick(answer) {
                userAnswers[currentQuestionIndex] = answer;
                currentQuestionIndex++;
                if (currentQuestionIndex < quizData.length) {
                    renderQuestion(currentQuestionIndex);
                } else {
                    showPage('email');
                }
            }

            function handleBackClick() {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--;
                    renderQuestion(currentQuestionIndex);
                }
            }
            
            async function handleEmailSubmit(e) {
                e.preventDefault();
                const email = emailInput.value;
                if (!email) return;

                showPage('loading');

                const formData = new FormData();
                formData.append('email', email);
                formData.append('timestamp', new Date().toISOString());

                try {
                    const response = await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (!response.ok) {
                       // Even if it fails, show the result to the user.
                       console.error('Failed to submit email, but showing result anyway.');
                    }

                } catch (error) {
                    console.error('Error submitting email:', error);
                    // Still show result to user regardless of submission error
                }
                
                showResult();
            }

            function showResult() {
                const randomIndex = Math.floor(Math.random() * cardImages.length);
                const selectedCard = cardImages[randomIndex];
                resultCard.src = selectedCard;
                downloadLink.href = selectedCard;
                downloadPrompt.href = selectedCard;
                showPage('result');
            }

            // --- EVENT LISTENERS ---
            startBtn.addEventListener('click', () => {
                showPage('quiz');
                renderQuestion(currentQuestionIndex);
            });
            
            backBtn.addEventListener('click', handleBackClick);
            emailForm.addEventListener('submit', handleEmailSubmit);
            
            shareFacebook.addEventListener('click', () => {
                const url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(shareURL)}&quote=${encodeURIComponent(shareText)}`;
                window.open(url, '_blank');
            });
            
            shareLine.addEventListener('click', () => {
                const url = `https://line.me/R/msg/text/?${encodeURIComponent(shareText + '\n' + shareURL)}`;
                window.open(url, '_blank');
            });

            shareThreads.addEventListener('click', () => {
                const url = `https://www.threads.net/intent/post?text=${encodeURIComponent(shareText + '\n' + shareURL)}`;
                window.open(url, '_blank');
            });

        });
    </script>
</body>
</html>