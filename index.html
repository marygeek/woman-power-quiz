<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>回答問題，獲得專屬於妳的 WOMEN 女力！- 我沒有腳本，但我有方向</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap');

        :root {
            --bg-color: #f5f0ec;
            --primary-text: #544c43;
            --title-green: #5e743e;
            --title-pink: #c4646b;
            --button-bg: #c0676d;
            --button-text: #ffffff;
            --button-hover-bg: #a8565b; 
        }

        body {
            margin: 0;
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg-color);
            background-image: url("data:image/svg+xml,%3Csvg width='6' height='6' viewBox='0 0 6 6' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='%239C92AC' fill-opacity='0.1'%3E%3Cpath d='M5 0h1L0 6V5zM6 5v1H5z'/%3E%3C/g%3E%3C/svg%3E");
            color: var(--primary-text);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px 0;
            box-sizing: border-box;
        }

        .container {
            width: 100%;
            max-width: 400px;
            min-height: 600px;
            background-color: rgba(255, 255, 255, 0.6);
            border-radius: 20px;
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
            backdrop-filter: blur(4px);
            border: 1px solid rgba(255, 255, 255, 0.18);
            padding: 30px;
            box-sizing: border-box;
            text-align: center;
            display: flex;
            flex-direction: column;
            justify-content: center;
            position: relative;
            overflow: hidden;
			background: url('img/home-banner.png') no-repeat top center / contain,
			url('img/img-bg.png') no-repeat bottom center / contain;
			padding-top: 55px;
        }

        .page {
            width: 100%;
            height: 100%;
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            animation: fadeIn 0.5s ease-in-out;
        }

        .page.active {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1, h2 {
            font-weight: 700;
        }
        
        #welcome-page h1 {
            color: var(--title-green);
            font-size: 0;
			background: url(img/img-title.png) no-repeat center center / cover;
            width: 110%;
            height: 90px;
        }
        
        #welcome-page h1 span {
            color: var(--title-pink);
        }

        #welcome-page p {
            font-size: 1.1em;
            line-height: 1.8;
            margin: 20px 0 40px;
        }

        .question-header {
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        #question-counter {
            font-size: 1em;
            color: var(--title-pink);
        }

        #back-button {
            background: none;
            border: 1px solid var(--primary-text);
            color: var(--primary-text);
            border-radius: 20px;
            padding: 5px 15px;
            cursor: pointer;
            visibility: hidden;
        }
        
        #back-button:hover {
            background: rgba(0,0,0,0.05);
        }

        #question-text {
            font-size: 1.5em;
            margin-bottom: 30px;
            line-height: 1.6;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .options-container {
            display: flex;
            flex-direction: column;
            width: 100%;
            gap: 15px;
        }

        .option-btn, .action-btn {
            background-color: var(--button-bg);
            color: var(--button-text);
            border: none;
            border-radius: 10px;
            padding: 18px 20px;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s;
            width: 100%;
            box-sizing: border-box;
            font-family: 'Noto Sans TC', sans-serif;
        }

        .option-btn:hover, .action-btn:hover {
            background-color: var(--button-hover-bg);
            transform: scale(1.02);
        }
        
        #email-page h2 {
            color: var(--title-green);
            font-size: 1.6em;
            margin-bottom: 15px;
        }
        
        #email-page p {
            margin-bottom: 30px;
            font-size: 1.1em;
            line-height: 1.7;
        }
        
        .form-group {
            width: 100%;
            margin-bottom: 20px;
            text-align: left;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-size: 0.9em;
        }
        #area-input, #age-select { /* --- MODIFIED: email-input changed to area-input --- */
            width: 100%;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 10px;
            font-size: 1em;
            box-sizing: border-box;
        }
        #area-input {
            text-align: center;
        }
        #age-select {
            text-align: left;
        }

        #result-card {
            max-width: 100%;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .download-link {
            display: inline-block;
            margin-bottom: 25px;
            font-size: 0.9em;
            color: var(--primary-text);
        }
        
        .share-container p {
            margin: 0 0 10px 0;
            font-weight: bold;
        }

        .share-buttons {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
        }

        .share-btn {
            background-color: transparent;
            border: none;
            cursor: pointer;
            padding: 0;
            transition: transform 0.2s;
        }
        .share-btn:hover {
            transform: scale(1.1);
        }
        .share-btn img {
            width: 48px;
            height: 48px;
        }

        #loading-page {
            font-size: 1.2em;
        }
		#result-page {margin-top: 30px;}
    </style>
</head>
<body>

    <div class="container">
        <div id="welcome-page" class="page active">
            <h1>回答問題，獲得專屬於妳的WOMEN 女力</h1>
            <p>走完五個展區，妳是否和我一樣，<br>看見了屬於自己的故事？<br>只要再回答以下提問，<br>就能抽取一張 WOMEN 女力牌卡，<br>收到專屬於妳的祝福與力量！</p>
            <button id="start-btn" class="action-btn">開始作答吧!</button>
        </div>

        <div id="quiz-page" class="page">
            <div class="question-header">
                <button id="back-button">&lt; 上一題</button>
                <span id="question-counter"></span>
            </div>
            <h2 id="question-text"></h2>
            <div class="options-container" id="options-container"></div>
        </div>

        <div id="email-page" class="page">
            <h2>領取妳的專屬女力卡</h2>
            <p>請填寫您的基本資料，我們將立即為您揭曉專屬的女力牌卡。</p>
            <form id="email-form" style="width:100%;">
                <div class="form-group">
                    <label for="area-input">您的居住區域</label>
                    <input type="text" id="area-input" placeholder="例如：台北市文山區，新北市板橋區..." required>
                </div>
                <div class="form-group">
                    <label for="age-select">您的年齡</label>
                    <select id="age-select" required>
                        <option value="" disabled selected>請選擇您的年齡區間</option>
                        <option value="18歲以下">18歲以下</option>
                        <option value="18-25歲">18-25歲</option>
                        <option value="26-35歲">26-35歲</option>
                        <option value="36-45歲">36-45歲</option>
                        <option value="46-55歲">46-55歲</option>
                        <option value="56-65歲">56-65歲</option>
                        <option value="65歲以上">65歲以上</option>
                    </select>
                </div>
                <button type="submit" class="action-btn">領取我的女力卡</button>
            </form>
        </div>

        <div id="loading-page" class="page">
            <p>正在生成您的女力卡...</p>
        </div>

        <div id="result-page" class="page">
            <a id="download-link" href="#" download="我的女力卡.jpg">
                <img id="result-card" src="" alt="女力卡">
            </a>
            <a id="download-prompt" class="download-link" href="#" download="我的女力卡.jpg">點此下載圖片，或長按圖片儲存</a>
            <div class="share-container">
                <p>分享妳的力量</p>
                <div class="share-buttons">
                    <button class="share-btn" id="share-facebook">
                        <img src="https://img.icons8.com/color/48/facebook-new.png" alt="facebook-new"/>
                    </button>
                    <button class="share-btn" id="share-line">
                        <img src="https://img.icons8.com/color/48/line-me.png" alt="line-me"/>
                    </button>
                    <button class="share-btn" id="share-threads">
                        <img src="https://img.icons8.com/ios-filled/50/threads.png" alt="threads"/>
                    </button>
                    <button class="share-btn" id="share-instagram">
                        <img src="https://img.icons8.com/fluency/48/instagram-new.png" alt="instagram-new"/>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- CONFIGURATION ---
            const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxqid2o7etbAXLFbgyd0dAXS_UbgVXsfHwuutZBPN3ijNShEcm8gHWdV4gd_hmZykZv/exec';
            const BASE_URL = 'https://woman-power-quiz.vercel.app'; 

            const quizData = [
                {
                    question: "展區一：新生兒的姓氏只能隨父姓或隨母姓？",
                    options: ["是", "否"]
                },
                {
                    question: "展區二：顏色、服飾、稱呼...許多日常事物都可能隱含性別的暗示？",
                    options: ["是", "否"]
                },
                {
                    question: "展區三：如果人生可以重來，我希望回到哪個階段？",
                    options: ["剛出生", "青春期", "成熟期", "中高齡期", "不想重來"]
                },
                {
                    question: "展區四：面對熟齡生活的改變，我的態度是？",
                    options: ["欣然接受", "順其自然", "恐懼緊張", "做好準備", "還沒想好"]
                }
            ];

            const cardImages = [
                "card/01.png", "card/02.png", "card/03.png", "card/04.png", "card/05.png"
            ];
            
            const baseShareText = '我的專屬女力卡！快來新北市婦女服務中心，參觀女性生命週期常設展「我沒有腳本，但我有方向」！';
            const websiteURL = 'https://ntwsc.tw/';
            const finalShareText = `${baseShareText}\n展覽資訊請上官網：${websiteURL}`;

            // --- DOM ELEMENTS ---
            const pages = {
                welcome: document.getElementById('welcome-page'),
                quiz: document.getElementById('quiz-page'),
                email: document.getElementById('email-page'),
                loading: document.getElementById('loading-page'),
                result: document.getElementById('result-page')
            };

            const startBtn = document.getElementById('start-btn');
            const backBtn = document.getElementById('back-button');
            const questionCounter = document.getElementById('question-counter');
            const questionText = document.getElementById('question-text');
            const optionsContainer = document.getElementById('options-container');
            const emailForm = document.getElementById('email-form');
            // --- MODIFIED: Get new area input element ---
            const areaInput = document.getElementById('area-input'); 
            const ageSelect = document.getElementById('age-select');
            const resultCard = document.getElementById('result-card');
            const downloadLink = document.getElementById('download-link');
            const downloadPrompt = document.getElementById('download-prompt');
            const shareFacebook = document.getElementById('share-facebook');
            const shareLine = document.getElementById('share-line');
            const shareThreads = document.getElementById('share-threads');
            const shareInstagram = document.getElementById('share-instagram');

            // --- STATE ---
            let currentQuestionIndex = 0;
            let userAnswers = [];
            let selectedCardRelativePath = '';

            // --- FUNCTIONS ---
            function showPage(pageName) {
                Object.values(pages).forEach(page => page.classList.remove('active'));
                pages[pageName].classList.add('active');
            }

            function renderQuestion(index) {
                const question = quizData[index];
                questionCounter.textContent = `問題 ${index + 1} / ${quizData.length}`;
                questionText.textContent = question.question;
                optionsContainer.innerHTML = '';

                question.options.forEach(optionText => {
                    const button = document.createElement('button');
                    button.textContent = optionText;
                    button.className = 'option-btn';
                    button.addEventListener('click', () => handleOptionClick(optionText));
                    optionsContainer.appendChild(button);
                });

                backBtn.style.visibility = index > 0 ? 'visible' : 'hidden';
            }

            function handleOptionClick(answer) {
                userAnswers[currentQuestionIndex] = answer;
                currentQuestionIndex++;
                if (currentQuestionIndex < quizData.length) {
                    renderQuestion(currentQuestionIndex);
                } else {
                    showPage('email');
                }
            }

            function handleBackClick() {
                if (currentQuestionIndex > 0) {
                    currentQuestionIndex--;
                    renderQuestion(currentQuestionIndex);
                }
            }
            
            // --- MODIFIED: handleEmailSubmit function updated ---
            async function handleEmailSubmit(e) {
                e.preventDefault();
                const area = areaInput.value; // Get area value
                const age = ageSelect.value;
                if (!area || !age) {
                    alert('請填寫所有欄位！');
                    return;
                }

                showPage('loading');

                const formData = new FormData();
                formData.append('area', area); // Append area data
                formData.append('age', age);
                formData.append('timestamp', new Date().toISOString());

                try {
                    const response = await fetch(GOOGLE_SCRIPT_URL, {
                        method: 'POST',
                        body: formData
                    });
                    
                    if (!response.ok) {
                       console.error('Failed to submit data, but showing result anyway.');
                    }

                } catch (error) {
                    console.error('Error submitting data:', error);
                }
                
                showResult();
            }

            function showResult() {
                const randomIndex = Math.floor(Math.random() * cardImages.length);
                selectedCardRelativePath = cardImages[randomIndex];
                resultCard.src = selectedCardRelativePath;
                downloadLink.href = selectedCardRelativePath;
                downloadPrompt.href = selectedCardRelativePath;
                showPage('result');
            }

            // --- EVENT LISTENERS ---
            startBtn.addEventListener('click', () => {
                showPage('quiz');
                renderQuestion(currentQuestionIndex);
            });
            
            backBtn.addEventListener('click', handleBackClick);
            emailForm.addEventListener('submit', handleEmailSubmit);
            
            shareFacebook.addEventListener('click', () => {
                const imageUrl = `${BASE_URL}/${selectedCardRelativePath}`;
                const url = `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(imageUrl)}&quote=${encodeURIComponent(finalShareText)}`;
                window.open(url, '_blank');
            });
            
            shareLine.addEventListener('click', () => {
                const imageUrl = `${BASE_URL}/${selectedCardRelativePath}`;
                const text = `${finalShareText}\n圖片連結：${imageUrl}`;
                const url = `https://line.me/R/msg/text/?${encodeURIComponent(text)}`;
                window.open(url, '_blank');
            });

            shareThreads.addEventListener('click', () => {
                const imageUrl = `${BASE_URL}/${selectedCardRelativePath}`;
                const text = `${finalShareText}\n${imageUrl}`;
                const url = `https://www.threads.net/intent/post?text=${encodeURIComponent(text)}`;
                window.open(url, '_blank');
            });

            shareInstagram.addEventListener('click', () => {
                alert('請先下載圖片，再到 Instagram App 中分享至限時動態！');
            });

        });
    </script>
</body>
</html>